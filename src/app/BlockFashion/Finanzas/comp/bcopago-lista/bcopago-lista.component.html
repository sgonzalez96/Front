<panel title="Pagos de usuarios">
  <div class="register-content">
      <!-- begin table-responsive -->
      <div>
          <div class="form-group row m-b-15">
            <label class="control-label col-md-1">Núcleo</label>
            <div class="col-md-2 m-b-15">
              <input *ngIf="nivel >= 50" type="text" [(ngModel)]="idNuc" name="id_nuc" class="form-control" (change)="cambioNuc($event.target.value)" placeholder="" appOnlydigits maxlength="4" />
              <input *ngIf="50 > nivel" type="text" [(ngModel)]="idNuc" name="id_nuc" class="form-control" (change)="cambioNuc($event.target.value)" placeholder="" appOnlydigits maxlength="4" disabled />
            </div>
            <div class="col col-md-3">
              <input type="text" [ngModel]="objNuc.nombre" name="nomdis" class="form-control" placeholder="" disabled/>
            </div>

            <button type="button" (click)="openNuc(selectNuc)" class="btn btn-white height-30  m-l-10 width-40" title="" >
                <span class="fa fa-search btn-icon mr-2"></span></button>

            <!-- <div *ngIf="objNuc != null && objNuc != undefined && objNuc.id == 1 " class="col col-md-6"> -->
            <label *ngIf="objNuc != null && objNuc != undefined && objNuc.id == 1" class="control-label col-md-1">Cédula</label>
            <div *ngIf="objNuc != null && objNuc != undefined && objNuc.id == 1" class="col-md-2 m-b-15">
              <input *ngIf="20 > nivel  || nivel >= 50 "type="text" [(ngModel)]="idAfi" name="id_afil" class="form-control" (change)="cambioAfi($event.target.value)" placeholder="" appOnlydigits maxlength="8" />
              <input *ngIf="nivel >= 20 && 50>nivel   "type="text" [(ngModel)]="idAfi" name="id_afil" class="form-control" (change)="cambioAfi($event.target.value)" placeholder="" appOnlydigits maxlength="8" disabled />
            </div>
            <div *ngIf="objNuc != null && objNuc != undefined && objNuc.id == 1" class="col col-md-3">
              <input *ngIf="objAfi != null && objAfi!=undefined" type="text" [(ngModel)]="objAfi.apellidos" name="apeds" class="form-control" placeholder="" disabled/>
            </div>
            <!-- </div> -->
          </div>
          <div class="form-group row m-b-15">
              <div class="col col-md-2">
                  <select class="form-control " (change)="onChangeTipo($event.target.value)">
                      <option *ngFor="let item of varsOpcion" [selected]="item.trim() == laopcion.trim()" name="cmbitm">{{item}}</option>
                  </select>
              </div>

              <label class="col col-md-1" >Desde/Hasta</label>
              <div class="m-l-10">
                  <input type="date" [(ngModel)]="fecini" name="feci" class="form-control" placeholder="" required maxlength="100"/>
              </div>
              <div class="m-l-10">
                  <input type="date" [(ngModel)]="fecfin" name="fecf" class="form-control" placeholder="" required maxlength="100"/>
              </div>
              <div class="m-l-10">
                  <button type="button" class="btn btn-warning height-30 width-40 m-l-20"
                  title=""  (click)="cargo()" ><span class="fa fa-redo btn-icon mr-2"></span></button>

                  <button *ngIf="hayalta" type="button" class="btn btn-white height-30  m-l-40 " [routerLink]="['/pagoalta', idNuc, idAfi]"
                  title=""  routerLinkActive="router-link-active"><span class="fa fa-plus btn-icon mr-2" style="color: darkred;"></span>Nuevo Pago</button>
                  <button *ngIf="!hayalta" type="button" class="btn btn-white height-30  m-l-40 " [routerLink]="['/pagoalta', idNuc, idAfi]"
                  title=""  routerLinkActive="router-link-active" disabled><span class="fa fa-plus btn-icon mr-2" style="color: darkred;"></span>Nuevo Pago</button>

                  <button type="button" class="btn btn-white height-30  m-l-20 " (click)="exportExcel()" title=""><span class="fa fa-file-excel btn-icon mr-2"></span>Exportar</button>
              </div>
          </div>
      </div>


      <div class="table-responsive">
          <table class="table table-striped m-b-0">
              <thead>
                  <tr>
                      <th>Via de Pago</th>
                      <th>Fecha</th>
                      <th>Descripcion</th>
                      <th>Referencia </th>
                      <th>Importe</th>
                      <th>Estado</th>
                      <th width="1%"></th>
                  </tr>
              </thead>
              <tbody>
                  <tr *ngFor="let item of lista">
                      <td>{{item.via.nombre}}</td>
                      <td>{{item.fecha|date:'dd/MM/yy'}}</td>
                      <td>{{item.descripcion}}</td>
                      <td>{{item.referencia}}</td>
                      <td style="text-align: right;">{{item.importe}}</td>
                      <td>{{item.estado}}</td>
                      <td class="with-btn" nowrap>

                              <button *ngIf="item.estado.trim() != ''" type="button" class="btn btn-white height-30 " [routerLink]="['/pagover', item.id]"  routerLinkActive="router-link-active"
                              title="Ver movimiento"><span class="fa fa-eye btn-icon mr-2" style="font-size:12px"></span> </button>

                              <button *ngIf="item.estado.trim() == ''" type="button" class="btn btn-white height-30 " [routerLink]="['/pagoedit', item.id]"  routerLinkActive="router-link-active"
                              title="Modificar datos del pago"><span class="fa fa-pencil-alt btn-icon mr-2" style="font-size:12px"></span> </button>

                              <button *ngIf="item.estado.trim() == ''" type="button" class="btn btn-white height-30 "
                              (click)="inhab(item.id)"
                              title="Descartar"><span class="fa fa-trash btn-icon mr-2" style="font-size:12px"></span> </button>

                              <button *ngIf="item.estado.trim() == 'X'" type="button" class="btn btn-white height-30 "
                              (click)="inhab(item.id)"
                              title="Reactivar"><span class="fa fa-check btn-icon mr-2" style="font-size:12px"></span> </button>

                      </td>
                  </tr>
              </tbody>
          </table>
      </div>
      <!-- end table-responsive -->
  </div>
  <!-- end register-content -->
</panel>
<!-- end panel -->

<!-- popup buscar nucleo -->
<ng-template #selectNuc let-c="close" let-d="dismiss">
    <app-helpnuc (nucleoChange)="objNuc=$event"  (winNChange)="elijoNuc()" (winNClose)="closeNuc()" ></app-helpnuc>
</ng-template>

