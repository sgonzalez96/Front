<!-- start page title -->
<app-pagetitle title="{{title}}"></app-pagetitle>
<!-- end page title -->

<div class="row">
    <div class="col-12">
        <div class="card">
            <form #f [formGroup]="formDataProfile" (ngSubmit)="modifyUser(f)" class="margin-bottom-0">
                <div class="card-title my-2 text-center">
                    <div class="pass-button">
                        <button type="button" (click)="openChangePass(changePassword)"
                            class="btn-rounded btn-lg btn-primary"><i class="fas fa-key"></i></button>
                    </div>
                    <div class="edit-button">
                        <button type="button" (click)="editProfile()" class="btn-rounded btn-lg btn-primary"><i
                                class="bx bx-edit-alt"></i></button>
                    </div>
                    <div *ngIf="esEdit" class="edit-button">
                        <button type="submit" class="btn-rounded btn-lg btn-primary"><i class="bx bx-save"></i></button>
                    </div>
                    <div *ngIf="esEdit" class="close-button">
                        <button type="button" (click)="cancelProfile()" class="btn-rounded btn-lg btn-warning"><i
                                class="bx bx-x-circle"></i></button>
                    </div>
                    <img [src]="previewUrl" class="avatar-lg" appImgWrong alt="img-profile">
                    <div *ngIf="esEdit" class="my-2">
                        <label class="control-label">Seleccione foto<span class="text-danger">*</span></label>
                        <input #imageInput type="file" accept="image/*" (change)="processFile($event)">
                    </div>

                    <!-- data ahead -->
                    <div class="row justify-content-md-center">
                        <div class="col-4 my-2">
                            <input type="text" [readonly]="!esEdit" formControlName="fullname"
                                [ngClass]="{'enabled-name': esEdit }" class=" text-center form-control-plaintext"
                                autocomplete="off" id="fullname"
                                [ngClass]="{ 'is-invalid': submitted && f.fullname.errors }">

                            <div *ngIf="submitted && f.fullname.errors" class="invalid-feedback">
                                <div *ngIf="f.fullname.errors.required">El nombre es requerido</div>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="card-body">
                    <div class="row">
                        <div class="col-6 mb-3">
                            <label class="fw-semibold" for="username">Nombre de usuario</label>
                            <input type="text" formControlName="username" class="form-control" autocomplete="off"
                                id="username" placeholder="" [readonly]="true"
                                [ngClass]="{ 'is-invalid': submitted && f.username.errors }">
                            <div *ngIf="submitted && f.username.errors" class="invalid-feedback">
                                <div *ngIf="f.username.errors.required">Usuario requerido</div>
                            </div>
                        </div>

                        <div class="col-6 mb-3">
                            <label class="fw-semibold" for="useremail">Email</label>
                            <input type="email" formControlName="email" class="form-control" autocomplete="off"
                                id="useremail" placeholder="" [readonly]="!esEdit"
                                [ngClass]="{ 'is-invalid': submitted && f.email.errors }">
                            <div *ngIf="submitted && f.email.errors" class="invalid-feedback">
                                <div *ngIf="f.email.errors.required">EL email es requerido</div>
                            </div>
                        </div>

                        <div class="col-6 mb-3">
                            <label class="fw-semibold" for="address">Dirección</label>
                            <input type="text" formControlName="address" class="form-control" autocomplete="off"
                                id="address" placeholder="" [readonly]="!esEdit">
                        </div>

                        <div class="col-6 mb-3">
                            <label class="fw-semibold" for="phone">Teléfono</label>
                            <input type="text" formControlName="phone" class="form-control" autocomplete="off"
                                id="phone" placeholder="" [readonly]="!esEdit">
                        </div>

                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- popup change password current user  -->
<ng-template #changePassword let-c='close' let-d='dismiss'>
    <div class='modal-header'>
        <h4 class='modal-title'>Seleccionar un núcleo existente</h4>
        <button type='button' class='close' (click)="d(' Cross click')">×</button>
    </div>
    <div class='modal-body'>
        <form #f id='form' [formGroup]="formPass" (ngSubmit)="savePass(f)">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-control-label" for="password">Contraseña</label>
                        <input class="form-control input-md" placeholder="nueva" formControlName="pass" id="password" name="pass" type="password">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-control-label" for="password">Confirmar</label>
                        <input class="form-control input-md" (keyup)="verificStatus($event)" formControlName="conf" id="conf" name="pass" type="password">
                        <div class="alert-validator" *ngIf="!statusPass">
                            <div style="font-size: small; color: rgb(194, 48, 48);">
                                No Coinciden
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12"></div>
                <div class="col my-2">
                    <button type="submit" class="btn btn-primary btn-md">Guardar</button>
                </div>
            </div>

        </form>
    </div>
    <div class='modal-footer'>
        <button class='btn btn-white' (click)="c(' Close click')">Close</button>
    </div>
</ng-template>

<!-- <div class="register-content">
        <form  (ngSubmit)="modifyUser(f)" class="margin-bottom-0">
            <label class="control-label">Nombre de usuario</label>
            <div class="row row-space-10">
                <div class="col-md-6 m-b-15">
                    <input type="text" [(ngModel)]="user.userName" name="userName" class="form-control" disabled required />
                </div>
            </div>

            <label class="control-label">Nombre completo</label>
            <div class="row row-space-10">
                <div class="col-md-6 m-b-15">
                    <input type="text" [(ngModel)]="user.nombreCompleto" name="nombre" class="form-control" />
                </div>
            </div>
            <label class="control-label">Email</label>
            <div class="row m-b-15">
                <div class="col-md-12">
                    <input type="email" [(ngModel)]="user.email" name="email" class="form-control" />
                </div>
            </div>
            <label class="control-label">Teléfono</label>
            <div class="row m-b-15">
                <div class="col-md-12">
                    <input type="text" [(ngModel)]="user.telefono" name="telefono" class="form-control" />
                </div>
            </div>
            <label class="control-label">Dirección</label>
            <div class="row m-b-15">
                <div class="col-md-12">
                    <input type="text" [(ngModel)]="user.direccion" name="dire" class="form-control" />
                </div>
            </div>

            <div class="image-preview mb-3">
                <img [src]="previewUrl" appImgWrong  height="100" width="100">
            </div>

            <label class="control-label">Seleccione foto <span class="text-danger">*</span></label>
            <div class="row m-b-15">
                <div class="col-md-12">
                    <input #imageInput type="file" accept="image/*" (change)="processFile($event)">
                </div>
            </div>

            <div class="register-buttons">
                <button type="submit" class="btn btn-primary btn-block btn-lg mt-5">Editar perfil</button>
            </div>

        </form>
    </div> -->
<!-- end register-content -->

<!-- end panel -->